<HTML>
<HEAD>
<title>Setup.INI Developer's Guide</title>
</HEAD>

<!--#include virtual="cygwin-header.html"-->

<h1 align=center>Setup.INI Developer's Guide</h1>

<p>This document is intended for people who post packages to
sources.redhat.com, and thus need to make them available through the
standard Cygwin setup program.  This documents the syntax of the
setup.ini file, and the program that automatically generates it on a
regular basis.

<p> Recommended package versioning scheme: use the vendor's version
plus a suffix for ports of existing packages (i.e. bash 2.04 becomes
2.04-1, 2.04-2, etc, until bash 2.05 is ported, which would be 2.05-1,
etc).  For experimental builds, use a YYYYMMDD datestamp version (like
bash-20000901.tar.gz).  Binary tarballs are "package-version.tar.gz"
while source tarballs are "package-version-src.tar.gz".

<h2>Automatic setup.ini generation on sources.redhat.com</h2>

There is a script that runs on sources.redhat.com that collects
information from the<tt> latest </tt>and<tt> contrib </tt> directories
(possibly more in the future) and automatically generates the default
setup.ini.  If you are putting packages in these directories, it is
important that you understand how this program works.

<p>Files that end in ".tar.gz" automatically qualify as packages.  It
is assumed that the file is package-version[-src].tar.gz, and that the
version number starts with a digit.  Version numbers that look like
YYMMDD or YYYYMMDD indicate test versions, while other versions are
considered stable (curr or prev) versions.  Highest version numbers
are used for test and curr; the second highest stable version (if any)
is prev.

<p>I recommend you keep up to three versions of each package around:
The current version, the previous stable version, and one test
version.  By keeping a previous stable version around, you isolate
yourself (somewhat) from problems with partial mirrors.  When you add
a new "current" version, you can either keep the old "previous"
version, or make the old current version the new previous version,
depending on how stable they each were.

<h2><tt>setup.hint</tt></h2>

If the above rules don't work for your package, for some reason, you
can amend them with a file called<tt> setup.hint </tt> which provides
additional information for<tt> setup.ini </tt> to use.  Note that
these files must be in subdirectories named after the package
(i.e. <tt>latest/cygwin/setup.hint</tt> is for the cygwin package).
Each line in<tt> setup.hint </tt> is one of the following:

<pre>
sdesc <i>some text</i>
ldesc <i>some text</i>
skip
curr <i>version</i>
prev <i>version</i>
test <i>version</i>
</pre>

The curr, prev, and test lines indicate which versions should be used
for which sections of that package.  If any of them are valid, they
repace <em>all</em> versions in setup.ini.  The skip line indicates
that that package should not appear in setup.ini.  The sdesc and ldesc
texts are simply copied to setup.ini in the appropriate place.  Note
that these lines do not have colons while the setup.ini lines do.

<h2><tt>setup.ini</tt></h2>

<p>Note that<tt> setup.ini </tt> is now automatically generated.  This
section is for completeness, not instruction.

<p>Setup reads a file called<tt> setup.ini </tt> that resides on all
cygwin FTP mirrors.  There are a few (well, one) global parameters in
this file, followed by a list of packages.  Any line beginning
with<tt> # </tt> is ignored by setup and can be used to add commentary
to the file at any point.

<p><tt>setup-timestamp: <i>number</i></tt></p>

This line is at the beginning of all setup.ini files.  It indicates
the time that the setup.ini file was created.  Its only purpose is to
warn the user when the timestamp is <em>less</em> than the last
setup.ini used; i.e. it prevents accidental regression.  Use "perl -e
'print time'" to get a timestamp.

<p><tt>@ <i>package</i></tt></p>

Lines beginning with the "at" symbol indicate the start of a package
section.  Each package consists of a name, one or more descriptive
texts, and up to three version definitions.

<p><tt>sdesc: <i>some text</i></tt></p>

This is the "short description" of the package.  This text, if
available, replaces (<strong>not</strong> accompanies) the package
name in package listings.

<p><tt>ldesc: <i>some text</i></tt></p>

This is the "long description" of the package.  This text, if
available, is used as a supplimental description of the package.

<p><tt>[curr]<br>[prev]<br>[test]</tt></p>

These indicate the start of a version description within a package.
Note that<tt> [curr] </tt> is the default and may be omitted if that
version happens to be specified before the others.  "Curr" indicates
the current stable (preferred) version, "prev" is the previous stable
version, and "test" indicates a test or experimental version.

<p><tt>version: <i>version</i></tt></p>

Indicates the version of the package.  While this can be derived from
the file names, it currently is not, and in some cases cannot reliably
be.

<p><tt>install: <i>filename</i> <i>size-in-bytes</i></tt></p>

Indicates the file to install for that version, and its size in bytes.
The file name must include the full path (relative to setup.ini's
directory), and the file size must match the actual file size (setup
uses this to verify it got the whole file).

<p><tt>source: <i>filename</i> <i>size-in-bytes</i></tt></p>

Like the file to install, this is the corresponding sources.

<h3>Example</h3>

<pre>
setup-timestamp: 967844652

@ cygwin
sdesc: Cygwin Runtime
ldesc: A Posix runtime emulator for Windows platforms
version: 1.1.4
install: latest/cygwin/cygwin-1.1.4.tar.gz 1234567
source: latest/cygwin/cygwin-1.1.4.tar.gz 1341245
[prev]
version: 1.1.3
install: latest/cygwin/cygwin-1.1.3.tar.gz 1234580
source: latest/cygwin/cygwin-1.1.3.tar.gz 1341123

@ bash
[test]
version: 20000901
install: latest/bash/bash-20000901.tar.gz 276403
source:  latest/bash/bash-20000901-src.tar.gz 1892899
[curr]
version: 2.04
install: latest/bash/bash-2.04.tar.gz 277375
source:  latest/bash/bash-2.04-src.tar.gz 1815177

</pre>

<!--#include virtual="cygwin-footer.html"-->
